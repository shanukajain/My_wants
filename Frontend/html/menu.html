<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://kit.fontawesome.com/b06a377e67.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="../css/nav.css">
<link rel="stylesheet" href="../css/box.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<style>
a{
    text-decoration: none;
    color: black;
}
</style>
</head>
<body>
    <div id="top">
        <div id="carouselExampleControls" class="carousel slide" data-ride="carousel" style="background-color: rgb(73, 72, 72);">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <a href="./index.html">  <P style="color: white;">❤️VALENTINE DAY GIFT JUST DROOPED❤️ <u> SHOP THEM NOW</u></P></a>
              </div>
              <div class="carousel-item">
                <a href="./index.html"> <p style="color: white;">JUST DROOPED SUSTAINABLE & ONE-OF-A-KIND GIFTS. <u>SHOP COACH(RE)LOVED</u></p></a>
              </div>
              <div class="carousel-item">
               <a href="./index.html"><p style="color: white;">SHOP GIFT BY 2/8 AT NOON EST FOR DELIVERY BY 2/14. <u>SHOP GIFTS</u></p></a>
              </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        <div id="top11">
            <div>
                <select name="" id="filter">
                    <option value="">Price Filter</option>
                    <option value="asc">Low to High</option>
                    <option value="desc">High to Low</option>
                </select>
          <i class='	fas fa-box' style='font-size:20px; '><p style="font-family:Arial;" onclick="cart()"> Cart</p></i>
            </div>
            <div>
                <a href="../index.html"> <img src="../image/My.png" alt="" style="height: 55px; margin-top: -10px;"></a>
            </div>
            <div id="top2">
                <div>
                    <input type="text" placeholder="Search.." id="sear" name="search" style="border: 0px; border-bottom: 1px solid black;">
                    <button type="submit" style="border: 0px; background-color:transparent; margin-left: -35px;" onclick="search()"><i
                            class="fa fa-search"></i></button>
                </div>

                <div id="top21">
                    <div id="sign_up">
                        <a href="./signup.html" style="text-decoration: none;"><i class='fas fa-user-alt' style='font-size:24px'></i></a>
                        <h4>Sign_up</h4>
                    </div>
                    <div id="login">
                      <a href="./login.html">  <i class='fas fa-user-alt' style='font-size:24px'></i></a>
                        <h4>Login</h4>
                    </div>
                </div>
            </div>
        </div>
        <div id="menubar">
            <button>NEW</button>
            <button>SHOP BY</button>
            <button>WOMEN</button>
            <button>MEN</button>
            <button>BAGS</button>
            <button>COACH(RE)LOVED</button>
            <button>COACH INSIDER</button>
            <button>GIFT</button>
            <button>SALE</button>
            <hr>
        </div>

    </div>
    <hr>
    <div id="box3" style="margin-top: 100px;">
   
    </div>
    <div id="bottom">
        <div>
        <p><b>My Account</b></p></a>
        <p>Order& Refund</p>
        <p>Email Preferences</p>
        <p>Account Settings</p>
        </div>
        <div>
        <p><b>LET US HELP</b></p>
        <p>Contect Customer care</p>
        <p>Shoping Information</p>
        <p>Return Policy</p>
        <p>International Help</p>
        <p>Accessibility</p>
    </div>
        <div><p><b>COMPANY INFORMATION</b></p>
        <p>About Overstock</p>
        <p>Contact Us</p>
        <p>Careers</p>
        <p>Investor Relations</p>
        <p>Sell Your Product</p>
        <p>Supply Chain Transparency</p></div>
        <div>
            <p><b>MORE WAYS TO SHOP</b></p>
            <p>Tips & ideas</p>
            <p>Deals</p>
            <p>Clearance</p>
            <p>New Arrivals</p>
        </div>
    </div>
</body>
</html>
<script>
     let url="https://handsome-earmuffs-fly.cyclic.app/product/all";
     display(url);
    async function display(url){
    let res=await fetch(url);
    let data=await res.json();
    console.log(data);
    let newdata=data.map((ele,index)=>{
return`<div>
    <img src="${ele.Imagesrc}" alt="">
    <h3>${ele.name}</h3>
    <p>${ele.Details}</p>
    <h3>$${ele.Price}</h3>
    <button id="${ele._id}" class="cart">Add to cart</button>
</div>`
    }).join("");
    document.querySelector("#box3").innerHTML=newdata;
    let delop=document.querySelectorAll(".cart")
for(i=0;i<delop.length;i++){
    delop[i].addEventListener("click",async()=>{
        // console.log(i,"hello")
        let id=event.srcElement.id;
        let token=JSON.parse(localStorage.getItem("userdetails"))||"";
        console.log(token);
        if(token==""){
            alert("Login first.....");
        }else{
            let dat=data.filter((ele,index)=>{
        if(ele._id==id){
            return ele;
        }
        })
        console.log(dat)
        let res= await fetch(`https://handsome-earmuffs-fly.cyclic.app/cart/create`,{
            method:"POST",
            body:JSON.stringify(dat[0]),
            headers: {"Content-Type": "application/json","authorization":token.token}
        })
        let data1=await res.json();
        console.log(data1);
        alert("Product in your cart");
    }
    })
    }
}

function cart(){
    let token=JSON.parse(localStorage.getItem("userdetails"))||"";
    if(token==""){
        alert("Please login first...");
    }else {
        window.location="./cart.html"
    }
}
function search(){
let str=document.querySelector("#sear").value;
let ur=`https://handsome-earmuffs-fly.cyclic.app/product/search/?str=${str}`;
display(ur);
}
document.querySelector("#filter").addEventListener("click",()=>{
    let val=document.querySelector("#filter").value;
    let ur=`https://handsome-earmuffs-fly.cyclic.app/product/sort/${val}`;
    display(ur);
})
window.addEventListener("load",()=>{
    let user=JSON.parse(localStorage.getItem("userdetails"))||" ";
        // let user=JSON.parse(data);
        console.log(user)
        if(user!=" "){
            document.querySelector("#sign_up").innerHTML=`<i class='fas fa-user-alt' style='font-size:24px'></i><h4>${user.username}</h4>`;
            document.querySelector("#login").innerHTML=`<i class='fas fa-user-alt' style='font-size:24px' onclick="logout()"></i><h4 id="logout">Logout</h4>`
            document.querySelector("#logout").addEventListener("click",logout);
        }
    })
    function logout(){
        console.log("helo")
        localStorage.setItem("userdetails","");
        window.location="../index.html"
    }
</script>